<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.10.xsd">

    <changeSet id="0.1" author="NBykov">
        <sql>
            CREATE TABLE users
            (
                id            UUID PRIMARY KEY,
                login         varchar(255) not null,
                first_name    varchar,
                last_name     varchar,
                date_of_birth DATE,
                city          varchar,
                created_at timestamp default current_timestamp,
                updated_at timestamp default current_timestamp
            );
        </sql>
    </changeSet>

    <changeSet id="0.2" author="MVGrebenyuk">
        <sql>
            CREATE TABLE passwords
            (
                id       UUID PRIMARY KEY,
                password varchar(255),
                user_id  UUID not null references users(id)
            );
        </sql>
    </changeSet>

    <changeSet id="0.2.1" author="">
        <sql>
            insert into users (id, login, first_name, last_name, date_of_birth, city)
            values ('3fc69278-37c3-4b4b-9186-df7e44fe1684', 'bob', 'Bob', 'Parker', '1990-01-01', 'Voronezh');
            insert into passwords (id, password, user_id)
            values ('55034373-8c24-4939-83f6-0a50ddfd9836', '$2a$04$Fx/SX9.BAvtPlMyIIqqFx.hLY2Xp8nnhpzvEEVINvVpwIPbA3v/.i', '3fc69278-37c3-4b4b-9186-df7e44fe1684');
        </sql>
    </changeSet>

    <changeSet id="0.3" author="NBykov">
        <sql>
            CREATE TABLE user_details (
                id UUID PRIMARY KEY,
                avatar varchar,
                about_me varchar,
                user_id UUID not null references users(id)
            );
        </sql>
    </changeSet>

    <changeSet id="0.4" author="mvgrebenyuk">
        <sql>
            CREATE TABLE TRIP (
                 id uuid PRIMARY KEY,
                 title varchar,
                 short_title varchar,
                 author_id uuid references users(id),
                 region varchar(50),
                 country varchar(50),
                 city varchar (50),
                 level int,
                 price numeric,
                 length numeric,
                 duration time,
                 image varchar,
                 creation_date timestamp,
                 updated_date timestamp
            );

            INSERT INTO TRIP(id,title,short_title,author_id,region,country,
                             city,level,price,length,duration, image)
                             VALUES ('63861814-94ec-4420-863f-6a4bd98722de', 'Холмистый Воронеж',
                                     'But I must explain to you how all this mistaken idea of denouncing pleasure and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?',
                                     '3fc69278-37c3-4b4b-9186-df7e44fe1684', 'Europe', 'Russia',
                                     'Voronezh', '1', '200', '300', '12:00:00', null);

            INSERT INTO TRIP(id,title,short_title,author_id,region,country,
                             city,level,price,length,duration,image)
            VALUES ('eac8a838-570e-4ba8-b54e-84a6d84b04c3', 'Резной Петербург',
                    'But I must explain to you how all this mistaken idea of denouncing pleasure and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?',
                    '3fc69278-37c3-4b4b-9186-df7e44fe1684', 'Europe', 'Russia',
                    'Saint-P', '1', '200', '300', '12:00:00', null);

            INSERT INTO TRIP(id,title,short_title,author_id,region,country,
                             city,level,price,length,duration, image)
            VALUES ('f0d24ae1-d047-46c3-85e5-391e6bf996a1', 'Жаркий Батуми',
                    'But I must explain to you how all this mistaken idea of denouncing pleasure and praising pain was born and I will give you a complete account of the system, and expound the actual teachings of the great explorer of the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids pleasure itself, because it is pleasure, but because those who do not know how to pursue pleasure rationally encounter consequences that are extremely painful. Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain, but because occasionally circumstances occur in which toil and pain can procure him some great pleasure. To take a trivial example, which of us ever undertakes laborious physical exercise, except to obtain some advantage from it? But who has any right to find fault with a man who chooses to enjoy a pleasure that has no annoying consequences, or one who avoids a pain that produces no resultant pleasure?',
                    '3fc69278-37c3-4b4b-9186-df7e44fe1684', 'Europe', 'Georgia',
                    'Batumi', '1', '200', '300', '12:00:00', null);
        </sql>
    </changeSet>

    <changeSet id="0.5" author="mvgrebenyuk">
        <sql>
            create table roles
            (
                id         bigserial primary key,
                name       varchar(50) not null,
                created_at timestamp default current_timestamp,
                updated_at timestamp default current_timestamp
            );

            create table users_roles
            (
                user_id    UUID not null references users(id),
                role_id    bigint not null references roles (id),
                created_at timestamp default current_timestamp,
                updated_at timestamp default current_timestamp,
                primary key (user_id, role_id)
            );

            insert into roles (name)
            values ('ROLE_USER'),
                   ('ROLE_ADMIN');
        </sql>
    </changeSet>

    <changeSet id="0.6" author="mvgrebenyuk">
        <sql>
            CREATE TABLE favorites_to_user (
                                  trip_id uuid not null references trip(id),
                                  user_id uuid references users(id),
                                  primary key (user_id, trip_id)
            );
        </sql>
    </changeSet>

    <changeSet id="0.7" author="mvgrebenyuk">
        <sql>
            CREATE TABLE purchased_to_user (
                                               trip_id uuid not null references trip(id),
                                               user_id uuid references users(id),
                                               primary key (user_id, trip_id)
            );
        </sql>
    </changeSet>


</databaseChangeLog>